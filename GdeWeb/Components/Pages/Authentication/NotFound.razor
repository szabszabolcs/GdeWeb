@page "/404"
@attribute [AllowAnonymous]

@using GdeWeb.Components.Layout
@using GdeWeb.Interfaces
@using Microsoft.AspNetCore.Authorization

@inject IJSRuntime jsRuntime
@inject ISnackbarService snackbarService
@inject NavigationManager navigationManager

<style>
    .footer {
        display: none;
    }
</style>

<PageTitle>404</PageTitle>

<div class="main-page container-center">
    @if (!PageLoading)
    {
        <!-- BODY -->
        <BlazorAnimate.Animate Animation="Animations.ZoomIn" Delay="TimeSpan.FromSeconds(MainLayout.animationDelay)" Duration="TimeSpan.FromSeconds(MainLayout.animationDuration)" style="height: 100%">

            <MudGrid Justify="Justify.SpaceEvenly" Class="pa-0 h-100" Spacing="0">

                <MudItem xs="12" sm="12" md="12" lg="12" xl="12" xxl="12" Style="align-content: center; text-align: center;">

                    <MudCard Elevation="0" Class="card-max">
                        <MudCardMedia Image="favicon.png" Height="120" Style="width: 120px; margin-left: auto; margin-right: auto;" />
                        <MudCardContent>
                            <MudText Typo="Typo.h2">Az oldal nem található!</MudText>
                            <MudText Typo="Typo.body2">Kattintson a Vissza gombra a folytatáshoz.</MudText>
                        </MudCardContent>
                        <MudCardActions>
                            <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="@(() => NavigateBack())" Class="card-button">Vissza</MudButton>
                        </MudCardActions>
                    </MudCard>

                </MudItem>

            </MudGrid>

        </BlazorAnimate.Animate>
    }
    else
    {
        <!-- LOADING -->
        <div class="loading-center">
            <MudProgressCircular Color="Color.Secondary" Indeterminate="true" />
        </div>
    }
</div>

@code{
    [CascadingParameter]
    public MainLayout MainLayout { get; set; } = default!;

    // LOADING PARAMETERS
    private bool PageLoading = true; // true

    /// <summary>
    /// PAGE LOAD
    /// </summary>
    #region PAGE LOAD
    protected override async Task OnInitializedAsync()
    {
        try
        {
            await Task.Delay(1);
            base.OnInitialized();
        }
        catch (Exception ex)
        {
            snackbarService.ShowSnackbar(Severity.Error, $"Hiba történt a betöltés során: {ex.Message.ToString()}", MainLayout.pageWidth);
        }

        StateHasChanged();
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            // Page load end
            await Task.Delay(500);
            PageLoading = false;
            StateHasChanged();
        }
    }
    #endregion

    /// <summary>
    /// BUTTON FUNCTIONS
    /// </summary>
    #region BUTTON FUNCTIONS
    public void NavigateBack()
    {
        navigationManager.NavigateTo("/", true);
    }
    #endregion
}